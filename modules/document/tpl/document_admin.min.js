/*! Copyright (C) StreamUX <http://www.streamux.com> */
/**!
 * @concat js in modules 
 * project sux
 * date 06-01-2019
 * @brief jsux Modules Javascript
 **/
jsux.fn=jsux.fn||{},jsux.fn.list={limit:10,limitGroup:5,pagination:jsux.app.getPagination(),listManager:jsux.app.getListManager(),listMobileManager:jsux.app.getListManager(),setLayout:function(){var a=this,b=$("input[name=list_json_path]").val(),c={passover:0,limit:this.limit},d=null;return loadedHandler=null,b?(this.listManager.setResource(b),this.listMobileManager.setResource(b),this.listManager.initialize({id:"#dataList",tmpl:"#dataListTmpl",msg_tmpl:"#warnMsgTmpl"}),this.listMobileManager.initialize({id:"#dataMobileList",tmpl:"#dataListMobileTmpl",msg_tmpl:"#warnMsgMobileTmpl"}),d=function(b){a.listManager.reloadData(b.page,a.limit),a.listMobileManager.reloadData(b.page,a.limit)},loadedHandler=function(b){var c=b.data;c&&c.list&&c.list.length>0?(a.listManager.setData(c.list),a.listMobileManager.setData(c.list)):(a.listManager.reset(),a.listManager.setMsg(b.msg),a.listMobileManager.reset(),a.listMobileManager.setMsg(b.msg))},this.listManager.addEventListener("loaded",loadedHandler),this.pagination.addEventListener("change",d),this.pagination.initialize({el:".sx-pagination-group",id:"#paginList",tmpl:"#paginationTmpl",control:{prev:".sx-pagination-group .sx-nav-prev",next:".sx-pagination-group .sx-nav-next"}}),void jsux.getJSON(b,c,function(b){var c=b.data;c&&c.list&&c.list.length>0?(a.pagination.setData({total:c.total_num,limit:a.limit,limitGroup:a.limitGroup}),a.pagination.activateControl()):a.pagination.deactivateControl(),loadedHandler(b)})):void trace("input[name=list_json_path] 경로값을 입력하세요")},init:function(){this.setLayout()}},jsux.fn.add={activedTab:null,returnUrl:function(){var a=$("input[name=location_back]").val();return a?a:(trace("input[name=location_back] 경로값을 확인해주세요."),"")},loadTemplateContent:function(a,b){var c=this,d=$("input[name=template_path]").val(),e="";return a?d?(e=d+"?template="+a+"&template_mode="+b,void jsux.getJSON(e,function(a){a.data&&$.each(a.data,function(a,b){c.setTextAreaVal(a,b)})})):void trace("input[name=template_path] 경로값을 입력하세요."):void trace("loadTemplateContent : tmpl 파람값을 입력해주세요.")},getSelectVal:function(a){return $.trim($("select[name="+a+"]").val())},setSelectVal:function(a,b){$("select[name="+a+"]").val(b)},getRadioVal:function(a){return $("input:radio[name="+a+"]:checked").val()},setRadioVal:function(a,b){return $("input:radio[name="+a+"]:input[value="+b+"]").prop("checked",!0)},setTextAreaVal:function(a,b){$("textarea[name="+a+"]").val(b)},getCheckboxVal:function(a){var b="",c=$("input:checkbox[name="+a+"]:checked"),d=c.length;return $(c).each(function(a){b+=c[a].value,a<d-1&&(b+=",")}),b},checkLangKor:function(a){var b=/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/;return b.test(a)},checkFormVal:function(a){var b=a.category.value.length,c=a.document_name.value.length;return b<1?(trace("카테고리 이름을 입력하세요."),a.category.focus(),!1):this.checkLangKor(a.category.value)?(trace("카테고리 이름에 한글이 포함되어 있습니다."),a.category.focus(),!1):!(c<1)||(trace("페이지 이름을 입력하세요."),a.document_name.focus(),!1)},checkCategoryName:function(){var a={category:$("input[name=category]").val()};return""===a.category?(trace("카테고리명을 입력하세요."),void $("input[name=category]").focus()):void jsux.getJSON(jsux.rootPath+"document-admin/check-page",a,function(a){a.msg&&trace(a.msg)})},sendJson:function(a){var b=this,c={_method:a._method.value};$.each(a,function(a,d){var e="select|radio|checkbox|button|submit",f=$(d).attr("type")?$(d).attr("type"):d.nodeName.toLowerCase();"select"===d.nodeName.toLowerCase()?(d.value=b.getSelectVal(d.name),c[d.name]=d.value):"radio"===f&&d.checked?c[d.name]=d.value:f.match(e)||(c[d.name]=d.value)});var d=a.action;return d?void jsux.getJSON(d,c,function(a){trace(a.msg),a.result&&"Y"===a.result.toUpperCase()&&jsux.goURL(b.returnUrl())}):(trace("Action URL Not Exists"),!1)},setcontentByTab:function(a){var b=$(a.target).data("target");$content=$("textarea[name^=content]"),$content.each(function(a){var c=$(this),d=c.attr("name");if(b.match(d)){var e=$("textarea[name="+d+"]");e.hasClass("hide")&&e.removeClass("hide"),e.hasClass("show")||e.addClass("show")}else c.hasClass("show")&&c.removeClass("show"),c.hasClass("hide")||c.addClass("hide")})},setTab:function(a){var b=$(a.target).parent();this.activedTab.hasClass("active")&&this.activedTab.removeClass("active"),b.hasClass("active")||(b.addClass("active"),this.activedTab=b)},setEvent:function(){var a=this;$("form[name=f_document_add]").on("submit",function(b){b.preventDefault(),a.checkFormVal(b.target)&&a.sendJson(b.target)}),$("#templateType").on("change",function(a){jsux.fn.modify.loadTemplateContent(this.value,"o")}),$("#btnCancel").on("click",function(b){b.preventDefault(),jsux.goURL(a.returnUrl())}),$("#btnCheckCategory").on("click",function(b){a.checkCategoryName()}),$(".sx-nav-tabs > li > a").on("click",function(b){b.preventDefault(),a.setTab(b),a.setcontentByTab(b)})},setLayout:function(){var a=this;$(".sx-nav-tabs > li").each(function(b){var c=$(this);c.hasClass("active")&&(a.activedTab=c)}),this.loadTemplateContent("default","o")},init:function(){this.setLayout(),this.setEvent(),jsux.setAutoFocus()}},jsux.fn.modify={activedTab:null,returnUrl:function(){var a=$("input[name=location_back]").val();return a?a:(trace("input[name=location_back] 경로값을 확인해주세요."),"")},loadTemplateContent:function(a,b){var c=this,d=$("input[name=template_path]").val(),b=b?b:"p";return url="",a?d?(url=d+"?template="+a+"&template_mode="+b,void jsux.getJSON(url,function(a){a.data?$.each(a.data,function(a,b){c.setTextAreaVal(a,b)}):trace(a.msg)})):void trace("input[name=template_path] 경로값을 입력하세요."):void trace("loadTemplateContent : tmpl 파람값을 입력해주세요.")},getSelectVal:function(a){return $.trim($("select[name="+a+"]").val())},setSelectVal:function(a,b){$("select[name="+a+"]").val(b)},getRadioVal:function(a){var b=$("input:radio[name="+a+"]:checked").val();return b},setRadioVal:function(a,b){var c=$("input:radio[name="+a+"][value="+b+"]").attr("checked",!0);return c},getCheckboxVal:function(a){var b="",c=$("input:checkbox[name="+a+"]:checked"),d=c.length;return $(c).each(function(a){b+=c[a].value,a<d-1&&(b+=",")}),b},getTextAreaVal:function(a){var b=$("textarea[name="+a+"]").val();return b},setTextAreaVal:function(a,b){$("textarea[name="+a+"]").val(b)},checkLangKor:function(a){var b=/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/;return b.test(a)},checkFormVal:function(a){var b=a.document_name.value.length;return!(b<1)||(trace("페이지  이름을 입력하세요."),a.document_name.focus(),!1)},sendJson:function(a){var b=this,c={};$.each(a,function(a,d){var e="select|radio|checkbox|button|submit",f=$(d).attr("type")?$(d).attr("type"):d.nodeName.toLowerCase();"select"===d.nodeName.toLowerCase()?(d.value=b.getSelectVal(d.name),c[d.name]=d.value):"radio"===f&&d.checked===!0?c[d.name]=d.value:f.match(e)||(c[d.name]=d.value)});var d=a.action;return d?void jsux.getJSON(d,c,function(a){trace(a.msg),a.result&&"Y"===a.result.toUpperCase()&&jsux.goURL(b.returnUrl())}):(trace("Action URL Not Exists"),!1)},setcontentByTab:function(a){var b=$(a.target).data("target");$content=$("textarea[name^=content]"),$content.each(function(a){var c=$(this),d=c.attr("name");if(b.match(d)){var e=$("textarea[name="+d+"]");e.hasClass("hide")&&e.removeClass("hide"),e.hasClass("show")||e.addClass("show")}else c.hasClass("show")&&c.removeClass("show"),c.hasClass("hide")||c.addClass("hide")})},setTab:function(a){var b=$(a.target).parent();this.activedTab.hasClass("active")&&this.activedTab.removeClass("active"),b.hasClass("active")||(b.addClass("active"),this.activedTab=b)},setEvent:function(){var a=this,b=$("input[name=category]").val(),c=$("#templateType").val(),d="p";$("form[name=f_modify]").on("submit",function(b){b.preventDefault(),a.checkFormVal(b.target)===!0&&a.sendJson(b.target)}),$("#templateType").on("change",function(a){var c="o"===d?this.value:b;jsux.fn.modify.loadTemplateContent(c,d)}),$("input[name=template_mode]").on("change",function(a){d=this.value,"p"===d?($("#templateType").trigger("change"),$("#templateType").val(c),$("#templateType").attr("disabled",!0)):$("#templateType").attr("disabled",!1)}),$("#btnCancel").on("click",function(b){jsux.goURL(a.returnUrl())}),$(".sx-nav-tabs > li > a").on("click",function(b){b.preventDefault(),a.setTab(b),a.setcontentByTab(b)})},setLayout:function(){var a=this,b={id:$("input[name=id]").val()},c=$("input[name=modify_info_path]").val();return $(".sx-nav-tabs > li").each(function(b){var c=$(this);c.hasClass("active")&&(a.activedTab=c)}),c?void jsux.getJSON(c,b,function(b){var c=null,d=null;b.result&&"Y"===b.result.toUpperCase()&&b.data&&b.data.list?(d=b.data.list[0],c=$("input[type=text]"),$(c).each(function(a){d[this.name]&&(this.value=d[this.name])}),c=$("select"),$(c).each(function(a){d[this.name]&&(this.value=d[this.name])}),c=$("input[type=radio]"),$(c).each(function(b){this.value===d[this.name]&&a.setRadioVal(this.name,d[this.name])}),a.setTextAreaVal("content_tpl",d.content_tpl),a.setTextAreaVal("content_css",d.content_css),a.setTextAreaVal("content_js",d.content_js)):trace(b.msg);var e=a.getRadioVal("template_mode");"o"===e&&$("#templateType").attr("disabled",!1),jsux.setAutoFocus()}):void trace("input[name=modify_info_path] 경로값을 확인해주세요.")},init:function(){this.setLayout(),this.setEvent()}},jsux.fn.delete={returnUrl:function(){var a=$("input[name=location_back]").val();return a?a:(trace("input[name=location_back] 경로값을 확인해주세요."),"")},sendJson:function(){var a=this,b={_method:$("input[name=_method]").val(),category:$("input[name=category]").val(),id:$("input[name=id]").val()},c=$("form"),d=c[0].action;d||trace("Form action 호출 경로가 존재하지 않습니다."),jsux.getJSON(d,b,function(b){b.result&&"Y"===b.result.toUpperCase()?jsux.goURL(a.returnUrl()):trace(b.msg)})},setEvent:function(){var a=this;$("#btnConfirm").on("click",function(b){b.preventDefault(),a.sendJson()}),$("#btnCancel").on("click",function(b){b.preventDefault(),jsux.goURL(a.returnUrl())})},init:function(){this.setEvent()}};