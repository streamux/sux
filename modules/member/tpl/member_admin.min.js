/*! Copyright (C) StreamUX <http://www.streamux.com> */
/**!
 * @concat js in modules 
 * project sux
 * date 06-01-2019
 * @brief jsux Modules Javascript
 **/
jsux.fn=jsux.fn||{},jsux.fn.groupList={limit:10,limitGroup:5,pagination:jsux.app.getPagination(),listManager:jsux.app.getListManager(),listMobileManager:jsux.app.getListManager(),setLayout:function(){var a=this,b=$("input[name=list_json_path]").val(),c={passover:0,limit:this.limit},d=null,e=null;return this.listManager.setResource(b),this.listMobileManager.setResource(b),this.listManager.initialize({id:"#dataList",tmpl:"#dataListTmpl",msg_tmpl:"#warnMsgTmpl"}),this.listMobileManager.initialize({id:"#dataMobileList",tmpl:"#dataListMobileTmpl",msg_tmpl:"#warnMsgMobileTmpl"}),this.pagination.initialize({el:".sx-pagination-group",id:"#paginList",tmpl:"#paginationTmpl",control:{prev:".sx-pagination-group .sx-nav-prev",next:".sx-pagination-group .sx-nav-next"}}),d=function(b){a.listManager.reloadData(b.page,a.limit),a.listMobileManager.reloadData(b.page,a.limit)},e=function(b){var c=b.data;c&&c.list&&c.list.length>0?(a.listManager.setData(c.list),a.listMobileManager.setData(c.list)):(a.listManager.reset(),a.listManager.setMsg(b.msg),a.listMobileManager.reset(),a.listMobileManager.setMsg(b.msg))},this.listManager.addEventListener("loaded",e),this.pagination.addEventListener("change",d),b?void jsux.getJSON(b,c,function(b){var c=b.data;c&&c.list&&c.list.length>0?(a.pagination.setData({total:c.total_num,limit:a.limit,limitGroup:a.limitGroup}),a.pagination.activateControl()):a.pagination.deactivateControl(),e(b)}):void trace("input[name=list_json_path] 경로값을 입력하세요")},init:function(){this.setLayout()}},jsux.fn.groupAdd={returnUrl:function(){var a=$("input[name=location_back]").val();return a?a:(trace("input[name=location_back] 경로값을 확인해주세요."),"")},checkLang:function(a){var b=/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/;return b.test(a)},checkFormVal:function(a){var b=a.category.value.length;return!(b<1)||(trace("카테고리 영문 이름을 입력 하세요."),a.category.focus(),!1)},checkGroupID:function(a){var b=$("input[name=category]"),c={_method:"insert",category:b.val()},d=$("input[name=groupId_check_url]").val();return""===c.category?(trace("카테고리 이름을 입력해주세요."),void b.focus()):(d||trace("input[name=groupId_check_url] 경로를 입력해주세요."),void jsux.getJSON(d,c,function(a){a.msg&&trace(a.msg)}))},sendAndLoad:function(){var a=this,b={},c=$("form");$.each(c[0],function(a,c){var d="checkbox|button|submit|select",e=$(c),f=e.attr("type")?e.attr("type"):c.nodeName;f.match(d)||(b[e.attr("name")]=e.val())});var d=c[0].action;return d?void jsux.getJSON(d,b,function(b){b.result&&"Y"===b.result.toUpperCase()?jsux.goURL(a.returnUrl()):trace(b.msg)}):void trace("Form action 경로를 입력해주세요.")},setEvent:function(){var a=this;$("input[name=check_member_group]").on("click",function(b){a.checkGroupID()}),$("form").on("submit",function(b){b.preventDefault(),a.checkFormVal(b.target)===!0&&(a.checkLang(b.target.category.value)?trace("카테고리 그룹 이름에 한글이 포함되어 있습니다. \n영문으로 입력해주세요."):a.sendAndLoad())}),$("#btnCancel").on("click",function(b){b.preventDefault(),jsux.goURL(a.returnUrl())})},init:function(){this.setEvent(),jsux.setAutoFocus()}},jsux.fn.groupModify={returnUrl:function(){var a=$("input[name=location_back]").val();return a?a:(trace("input[name=location_back] 경로값을 확인해주세요."),"")},sendAndLoad:function(){var a={},b=$("form");$.each(b[0],function(b,c){var d="checkbox|button|submit|select",e=$(c),f=e.attr("type")?e.attr("type"):c.nodeName;f.match(d)||(a[e.attr("name")]=e.val())});var c=b[0].action;return c?void jsux.getJSON(c,a,function(a){trace(a.msg),a.result&&"Y"==a.result.toUpperCase()&&jsux.goURL(self.returnUrl())}):void trace("Form action 경로를 입력해주세요.")},setEvent:function(){var a=this;$("form[name=f_member_modify]").on("submit",function(b){b.preventDefault(),a.sendAndLoad()}),$("#btnCancel").on("click",function(b){b.preventDefault(),jsux.goURL(a.returnUrl())})},setLayout:function(){var a={id:$("input[name=id]").val()},b=$("input[name=modify_info_path]").val();return b?void jsux.getJSON(b,a,function(a){var b=null;a.result&&"Y"===a.result.toUpperCase()&&(b=$("input[type=text]"),$(b).each(function(b,c){a.data[this.name]&&(this.value=a.data[this.name])}))}):void trace("input[name=modify_info_path] 경로값을 입력하세요.")},init:function(){this.setLayout(),this.setEvent()}},jsux.fn.groupDelete={returnUrl:function(){var a=$("input[name=location_back]").val();return a?a:(trace("input[name=location_back] 경로값을 확인해주세요."),"")},sendJSON:function(){var a=this,b={_method:$("input[name=_method]").val(),id:$("input[name=id]").val()},c=$("form"),d=c[0].action;jsux.getJSON(d,b,function(b){b.result&&"Y"===b.result.toUpperCase()?jsux.goURL(a.returnUrl()):trace(b.msg)})},setEvent:function(){var a=this;$("#btnConfirm").on("click",function(b){b.preventDefault(),a.sendJSON()}),$("#btnCancel").on("click",function(a){a.preventDefault();var b=$("input[name=location_back]").val();jsux.goURL(b)})},init:function(){this.setEvent()}},jsux.fn.list={limit:10,limitGroup:5,pagination:jsux.app.getPagination(),listManager:jsux.app.getListManager(),listMobileManager:jsux.app.getListManager(),changeHandler:function(a){this.listManager.reloadData(a.page,this.limit),this.listMobileManager.reloadData(a.page,this.limit)},loadedHandler:function(a){var b=a.data;b&&b.list&&b.list.length>0?(this.listManager.setData(b.list),this.listMobileManager.setData(b.list)):(this.listManager.reset(),this.listManager.setMsg(a.msg),this.listMobileManager.reset(),this.listMobileManager.setMsg(a.msg))},sendAndLoad:function(a,b){var c=this;jsux.getJSON(a,b,function(a){var b=a.data;b&&b.list&&b.list.length>0?(c.pagination.setData({total:b.total_num,limit:c.limit,limitGroup:c.limitGroup}),c.pagination.activateControl()):c.pagination.deactivateControl(),c.loadedHandler(a)})},setEvent:function(){var a=this,b=$("input[name=list_json_path]").val();$("form[name=f_search]").on("submit",function(c){c.preventDefault();var d=c.target,e={category:$("input[name=category]").val(),find_group:d.find_group.value,find:d.find.value,search:d.search.value,passover:0,limit:a.limit};$(window).width()<768&&(e.find="user_id,nickname,email_address"),a.sendAndLoad(b,e)})},setLayout:function(){var a=$("input[name=list_json_path]").val(),b={category:$("input[name=category]").val(),passover:0,limit:this.limit};return a?(this.listManager.setResource(a),this.listMobileManager.setResource(a),this.listManager.initialize({id:"#dataList",tmpl:"#dataListTmpl",msg_tmpl:"#warnMsgTmpl"}),this.listMobileManager.initialize({id:"#dataMobileList",tmpl:"#dataListMobileTmpl",msg_tmpl:"#warnMsgMobileTmpl"}),this.pagination.initialize({el:".sx-pagination-group",id:"#paginList",tmpl:"#paginationTmpl",control:{prev:".sx-pagination-group .sx-nav-prev",next:".sx-pagination-group .sx-nav-next"}}),this.listManager.addEventListener("loaded",this.loadedHandler),this.pagination.addEventListener("change",this.changeHandler),void this.sendAndLoad(a,b)):void trace("input[name=list_json_path] 경로값을 입력하세요")},init:function(){this.setLayout(),this.setEvent()}},jsux.fn.add={returnUrl:function(){var a=$("input[name=location_back]").val();return a?a:(trace("input[name=location_back] 경로값을 확인해주세요."),"")},getSelectVal:function(a){var b=$.trim($("select[name="+a+"]").val());return b},setSelectVal:function(a,b){$("select[name="+a+"]").val(b)},getCheckboxVal:function(a){var b="",c=$("input:checkbox[name^="+a+"]:checked"),d=c.length;return $(c).each(function(a){b+=c[a].value,a<d-1&&(b+=",")}),b},checkLangKor:function(a){var b=/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/;return b.test(a)},validateEmail:function(a){var b=$("input:text[name="+a+"]").val(),c=/^([a-zA-Z0-9_+.-])+@([a-zA-Z0-9_-])+(\.[a-z0-9_-]+){1,2}$/;return!!c.test(b)},validateHp:function(a){var b,c=a.target.value;if(c=c.replace(/\s-\s/g,""),!(c.length>9&&c.length<12))return!1;if(10===c.length&&(b=/^(\d{3})+(\d{3})+(\d{4})+$/),11===c.length&&(b=/^(\d{3})+(\d{4})+(\d{4})+$/),!b.test(c))return!1;var d=c.replace(b,"$1 - $2 - $3");return $("input[name=hp]").val(d),!0},checkFormVal:function(a){var b=["아이디를","비밀번호를","비밀번호 확인을","닉네임을","이메일을"],c=["user_id","password","passwordConf","nickname","email_address"],d=!0;return $.each(c,function(c,e){var f=a[e];if(f.value.length<1)return trace(b[c]+" 입력 하세요."),f.focus(),d=!1,!1}),!!d&&(!!this.validateEmail("email_address")||(trace("이메일이 올바르지 않습니다."),!1))},sendJson:function(a){var b=this,c={},d=$("form")[0],e=0,f="";$.each(d,function(a,d){var f="checkbox|button|submit",g=$(d).attr("type")?$(d).attr("type"):d.nodeName;if("select"===d.nodeName.toLowerCase()?(d.value=b.getSelectVal(d.name),c[d.name]=d.value):g.match(f)||(c[d.name]=d.value),"checkbox"===g&&d.checked){if(0===e){var h=d.name.substr(0,d.name.length-1);c[d.name]=b.getCheckboxVal(h)}e++}}),a.action||alert("Not Exists URL"),f=a.action,jsux.getJSON(f,c,function(a){trace(a.msg),"Y"===a.result.toUpperCase()&&jsux.goURL(b.returnUrl())})},checkPWD:function(){if($("input[name=passowrd]").val()!=$("input[name=passowrdConf]").val())return trace("비밀번호가 일치하지 않습니다."),$("input[name=passowrd]").val(""),$("input[name=passowrdConf]").val(""),$("input[name=passowrd]").focus(),!1},checkID:function(){var a=$("input[name=user_id]"),b={_method:$("input[name=_method]").val(),user_id:a.val()},c=$("input[name=id_check_url]").val();return a.val()?c?void jsux.getJSON(c,b,function(a){trace(a.msg)}):void trace("input[id_check_url] 경로값을 입력하세요."):(trace("아이디를 입력해주세요"),void a.focus())},setEvent:function(){var a=this;$("form").on("submit",function(b){b.preventDefault(),a.checkFormVal(this)===!0&&a.sendJson(b.target)}),$("#btnCancel").on("click",function(b){jsux.goURL(a.returnUrl())}),$("input[name=passowrdConf]").on("blur",function(){a.checkPWD()}),$("input[name=checkID]").on("click",function(b){a.checkID()}),$("input[name=hp]").on("keyup",function(b){a.validateHp(b)}),$("input[name=hp]").on("blur",function(a){$("input[name=hp]").off("keydown")})},setLayout:function(){jsux.setAutoFocus()},init:function(){this.setEvent()}},jsux.fn.modify={returnUrl:function(){var a=$("input[name=location_back]").val();return a?a:(trace("input[name=location_back] 경로값을 입력해주세요"),"")},getEmailVal:function(a){var b="";return b=$.trim($("select[name="+a+"1]").val()),"직접입력"==b&&(b=$("input[name="+a+"2]").val()),b},getSelectVal:function(a){var b=$.trim($("select[name="+a+"]").val());return b},setSelectVal:function(a,b){$("select[name="+a+"]").val(b)},getCheckboxVal:function(a){var b="",c=$("input:checkbox[name^="+a+"]:checked"),d=c.length;return $(c).each(function(a){b+=c[a].value,a<d-1&&(b+=",")}),b},checkLangKor:function(a){var b=/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/;return b.test(a)},changePassword:function(){var a=$("#panelNewPassword"),b=$("#btnChangePassword");"none"===a.css("display")?(b.val("변경 취소하기"),a.css("display","block"),b.hasClass("active")||b.addClass("active")):(b.val("변경하기"),a.css("display","none"),b.removeClass("active"),b.blur())},validatePassword:function(){var a=$("input[name=password]");if(!a.val())return!1;var b=$("#panelNewPassword");if("none"===b.css("display"))return!0;var c=$("input[name=new_password]"),d=$("input[name=new_password_conf]");return c.val()?c.val()===d.val()||(c.val(""),d.val(""),c.focus(),trace("새 비밀번호가 일치하지 않습니다."),!1):(trace("새 비밀번호를 입력하세요."),c.focus(),!1)},validateEmail:function(a){var b=$("input:text[name=email_address]").val(),c=/^([a-zA-Z0-9_+.-])+@([a-zA-Z0-9_-])+(\.[a-z0-9_-]+){1,2}$/;return!!c.test(b)||(trace("이메일이 올바르지 않습니다."),!1)},validateHp:function(a){var b,c=a.target.value;if(c=c.replace(/\s-\s/g,""),!(c.length>9&&c.length<12))return!1;if(10===c.length&&(b=/^(\d{3})+(\d{3})+(\d{4})+$/),11===c.length&&(b=/^(\d{3})+(\d{4})+(\d{4})+$/),!b.test(c))return!1;var d=c.replace(b,"$1 - $2 - $3");return $("input[name=hp]").val(d),!0},checkFormVal:function(a){var b=["비밀번호를","닉네임을","이메일을"],c=["password","nickname","email_address"],d=!0;return $.each(c,function(c,e){var f=a[e];if(f.value.length<1)return trace(b[c]+" 입력 하세요."),f.focus(),d=!1,!1}),!!d&&(!!this.validateEmail()&&!!this.validatePassword())},sendJson:function(a){var b=this,c={},d=$("form")[0],e=0;$.each(d,function(a,d){var f="checkbox|button|submit",g=$(d).attr("type")?$(d).attr("type"):d.nodeName;if("select"===d.nodeName.toLowerCase()?(d.value=b.getSelectVal(d.name),c[d.name]=d.value):g.match(f)||(c[d.name]=d.value),"checkbox"===g&&d.checked){if(0===e){var h=d.name.substr(0,d.name.length-1);c[h]=b.getCheckboxVal(h)}e++}}),a.action||alert("Not Exists URL"),url=a.action,jsux.getJSON(url,c,function(a){a.result&&"Y"===a.result.toUpperCase()?jsux.goURL(b.returnUrl()):trace(a.msg)})},setEvent:function(){var a=this;$("form").on("submit",function(b){b.preventDefault(),a.checkFormVal(b.target)===!0&&a.sendJson(b.target)}),$("#btnCancel").on("click",function(b){var c=a.returnUrl();""!==c&&jsux.goURL(c)}),$("#btnChangePassword").on("click",function(){a.changePassword()}),$("input[name=new_password_conf]").on("blur",function(b){a.validatePassword()}),$("input[name=hp]").on("keyup",function(b){a.validateHp(b)}),$("input[name=hp]").on("blur",function(a){$("input[name=hp]").off("keydown")})},setLayout:function(){var a={id:$("input[name=id]").val()},b=$("input[name=modify_info_path]").val();return b?void jsux.getJSON(b,a,function(a){var b=null,c="",d="",e=null;if("Y"==a.result){b=$("input[type=text]"),$(b).each(function(b){a.data[this.name]&&(this.value=a.data[this.name])});var f=/^(is_writable|is_kickout)$/;b=$("select"),$(b).each(function(b){var c=a.data[this.name];if(f.test(this.name)){var d="y"===c.toLowerCase()?"yes":"no";$(this).val(d)}else c&&$(this).val(c)}),b=$("input[type=checkbox]"),a.data.hobby&&(c=a.data.hobby.split(","),$(b).each(function(a){var b=this;$(c).each(function(a){c[a]&&b.value===c[a]&&(b.checked=!0)})})),d=$("#memberLabel_tmpl"),e=$(".view-type-textfield"),$(e).each(function(b){var c=$(e[b]).attr("id"),f={label:a.data[c]};$("#"+c).empty(),$(d).tmpl(f).appendTo($("#"+c))})}else trace(a.msg)}):void trace("input[name=modify_info_path] 경로값을 입력하세요.")},init:function(){this.setLayout(),this.setEvent(),jsux.setAutoFocus()}},jsux.fn.delete={returnUrl:function(){var a=($("input[name=id]").val(),jsux.rootPath+"member-admin/list");return a},sendJSON:function(a){var b=this,c={_method:"delete",category:a.category.value,id:a.id.value,user_id:a.user_id.value};jsux.getJSON(jsux.rootPath+"member-admin/delete",c,function(a){trace(a.msg),a.result&&"Y"===a.result.toUpperCase()&&jsux.goURL(b.returnUrl())})},setEvent:function(){var a=this;$("form[name=f_member_delete]").on("submit",function(b){b.preventDefault(),a.sendJSON(b.target)}),$("#btnCancel").on("click",function(b){b.preventDefault(),jsux.goURL(a.returnUrl())})},init:function(){this.setEvent()}};